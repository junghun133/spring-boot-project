<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="author" content="colorlib.com">
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet" />
    <link href="css/main.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style>
    body {
    font-family: 'Varela Round', sans-serif;
  }
  .modal-login {
    color: #636363;
    width: 350px;
    margin: 80px auto 0;
  }
  .modal-login .modal-content {
    padding: 20px;
    border-radius: 5px;
    border: none;
  }
  .modal-login .modal-header {
    border-bottom: none;
        position: relative;
        justify-content: center;
  }
  .modal-login h4 {
    text-align: center;
    font-size: 26px;
    margin: 30px 0 -15px;
  }
  .modal-login .form-control:focus {
    border-color: #70c5c0;
  }
  .modal-login .form-control, .modal-login .btn {
    min-height: 40px;
    border-radius: 3px;
  }
  .modal-login .close {
        position: absolute;
    top: -5px;
    right: -5px;
  }
  .modal-login .modal-footer {
    background: #ecf0f1;
    border-color: #dee4e7;
    text-align: center;
        justify-content: center;
    margin: 0 -20px -20px;
    border-radius: 5px;
    font-size: 13px;
  }
  .modal-login .modal-footer a {
    color: #999;
  }
  .modal-login .avatar {
    position: absolute;
    margin: 0 auto;
    left: 0;
    right: 0;
    top: -70px;
    width: 95px;
    height: 95px;
    border-radius: 50%;
    z-index: 9;
    background: #60c7c1;
    padding: 15px;
    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.1);
  }
  .modal-login .avatar img {
    width: 100%;
  }
    .modal-login .btn {
        color: #fff;
        border-radius: 4px;
    background: #60c7c1;
    text-decoration: none;
    transition: all 0.4s;
        line-height: normal;
        border: none;
    }
  .modal-login .btn:hover, .modal-login .btn:focus {
    background: #45aba6;
    outline: none;
  }
  .trigger-btn {
    display: inline-block;
    margin: 100px auto;
  }
    .table-responsive {
      margin: 30px 0;
    }
    .table-wrapper {
      min-width: 1000px;
      background: #fff;
      padding: 20px;
      box-shadow: 0 1px 1px rgba(0,0,0,.05);
    }
    .table-title {
      font-size: 15px;
      padding-bottom: 10px;
      margin: 0 0 10px;
      min-height: 45px;
    }
    .table-title h2 {
      margin: 5px 0 0;
      font-size: 24px;
    }
    .table-title select {
      border-color: #ddd;
      border-width: 0 0 1px 0;
      padding: 3px 10px 3px 5px;
      margin: 0 5px;
    }
    .table-title .show-entries {
      margin-top: 7px;
    }
    .search-box {
      position: relative;
      float: right;
    }
    .search-box .input-group {
      min-width: 200px;
      position: absolute;
      right: 0;
    }
    .search-box .input-group-addon, .search-box input {
      border-color: #ddd;
      border-radius: 0;
    }
    .search-box .input-group-addon {
      border: none;
      border: none;
      background: transparent;
      position: absolute;
      z-index: 9;
    }
    .search-box input {
      height: 34px;
      padding-left: 28px;
      box-shadow: none !important;
      border-width: 0 0 1px 0;
    }
    .search-box input:focus {
      border-color: #3FBAE4;
    }
    .search-box i {
      color: #a0a5b1;
      font-size: 19px;
      position: relative;
      top: 2px;
      left: -10px;
    }
    table.table tr th, table.table tr td {
      border-color: #e9e9e9;
    }
    table.table th i {
      font-size: 13px;
      margin: 0 5px;
      cursor: pointer;
    }
    table.table td:last-child {
      width: 130px;
    }
    table.table td a {
      color: #a0a5b1;
      display: inline-block;
      margin: 0 5px;
    }
    table.table td a.view {
      color: #03A9F4;
    }
    table.table td a.edit {
      color: #FFC107;
    }
    table.table td a.delete {
      color: #E34724;
    }
    table.table td i {
      font-size: 19px;
    }
    .pagination {
      float: right;
      margin: 0 0 5px;
    }
    .pagination li a {
      border: none;
      font-size: 13px;
      min-width: 30px;
      min-height: 30px;
      padding: 0 10px;
      color: #999;
      margin: 0 2px;
      line-height: 30px;
      border-radius: 30px !important;
      text-align: center;
    }
    .pagination li a:hover {
      color: #666;
    }
    .pagination li.active a {
      background: #03A9F4;
    }
    .pagination li.active a:hover {
      background: #0397d6;
    }
    .pagination li.disabled i {
      color: #ccc;
    }
    .pagination li i {
      font-size: 16px;
      padding-top: 6px
    }
    .hint-text {
      float: left;
      margin-top: 10px;
      font-size: 13px;
    }
</style>
  </head>
  <body>

   <script>
     temp = location.href.split("?")
     data = temp[1].split("=")
     apiKey = data[1]
     history.replaceState({}, null, location.pathname);
     alert(apiKey)
   </script>

   <script>
     apiurl = null;
     $(document).ready(function() {
       $('#find-btn').eq(0).bind("click", function() {
         searchQuery = $('#search').val();
         if(searchQuery == ''){
           alert('키워드를 입력해주세요');
           return;
         }
         apiurl = 'http://localhost:8080/v1/map/search/keyword?query=' + searchQuery;

         $.ajax({
           method : 'GET',
           contentType :'application/json',
           url : 'http://localhost:8080/v1/map/search/keyword?query=' + searchQuery,
           beforeSend : function (xhr){
               xhr.setRequestHeader("Authorization", apiKey)
           },

           success : function(data) {
             if (data.message == '성공') {
                 if(data.meta.total_count > 500){
                   alert("검색된 결과 수 : " + data.meta.total_count  + "\n결과 데이터가 너무 많아 500 이상은 조회되지않습니다. \n상세한 키워드를 입력해보는건 어떨까요?");
                 }else{
                   alert("검색된 결과 수 : " + data.meta.total_count);
                 }
                setTableData(data.documents);
                setMetaData(data.meta, data.documents.length);
             } else {
               alert('데이터 요청에 실패하였습니다.');
             }
           },
           error : function(e) {
             alert('서버 연결 도중 에러가 발생하였습니다. 다시 시도해 주십시오.');
           }
         });
       });
     });

     function setTableData(obj){


     }
     function setMetaData(obj, obj2){
       // var div = document.
         // obj.pageable_count
       $('#total_cnt_id').html(obj.total_count);
       $('#page_cnt').html(obj2);
       // obj.is_end
     }

   </script>
   <div class="s01">
      <form>
        <fieldset>
          <legend>지도 검색기</legend>
        </fieldset>
        <div class="inner-form">
          <div class="input-field first-wrap">
            <input id="search" type="text" placeholder="What are you looking for?" />
          </div>
          <div class="input-field third-wrap">
            <button id="find-btn" class="btn-search" type="button">찾기</button>
          </div>
        </div>
      </form>
    </div>

   <div class="container">
     <div class="table-responsive">
       <div class="table-wrapper">
         <div class="table-title">
           <div class="row">
             <div class="col-xs-4">
               <div class="show-entries">
                 <span>Show 15 entries</span>
               </div>
             </div>
             <div class="col-xs-4">
               <h2 class="text-center"><b>검색결과</b></h2>
             </div>

           </div>
         </div>
         <table id="map_table_id" class="table table-bordered">
           <thead>
           <tr>
             <th>#</th>
             <th>장소 이름<i class="fa fa-sort"></i></th>
             <th>카테고리</th>
             <th>Actions</th>
           </tr>
           </thead>
           <tbody>

           <tr>
             <td>4</td>
             <td>Dominique Perrier</td>
             <td>25, rue Lauriston</td>
             <td>
               <a href="#" class="view" title="View" data-toggle="tooltip"><i class="material-icons">&#xE417;</i></a>
             </td>
           </tr>
           <tr>
             <td>5</td>
             <td>Martin Blank</td>
             <td>Via Monte Bianco 34</td>
             <td>
               <a href="#" class="view" title="View" data-toggle="tooltip"><i class="material-icons">&#xE417;</i></a>
             </td>
           </tr>
           </tbody>
         </table>
         <div class="clearfix">
           <div class="hint-text">Showing <b id="page_cnt">5</b> out of <b id="total_cnt_id">${total_cnt}</b> entries</div>
           <ul class="pagination">
             <li class="page-item disabled"><a href="#">Previous</a></li>
             <li class="page-item"><a href="#" class="page-link">1</a></li>
             <li class="page-item"><a href="#" class="page-link">2</a></li>
             <li class="page-item active"><a href="#" class="page-link">3</a></li>
             <li class="page-item"><a href="#" class="page-link">4</a></li>
             <li class="page-item"><a href="#" class="page-link">5</a></li>
             <li class="page-item"><a href="#" class="page-link">Next</a></li>
           </ul>
         </div>
       </div>
     </div>
   </div>
  </body><!-- This templates was made by Colorlib (https://colorlib.com) -->
</html>
